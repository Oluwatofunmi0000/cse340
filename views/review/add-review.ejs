<h1>Add Review for <%= vehicle.inv_make %> <%= vehicle.inv_model %></h1>

<% if (locals.message) { %>
  <p class="notice"><%= locals.message %></p>
<% } %>

<% if (locals.errors && locals.errors.length > 0) { %>
  <ul class="errors">
    <% locals.errors.forEach(e => { %>
      <li><%= e.msg %></li>
    <% }) %>
  </ul>
<% } %>

<div class="vehicle-summary" style="background: #f5f5f5; padding: 1rem; margin: 1rem 0; border-radius: 4px;">
  <p><strong><%= vehicle.inv_make %> <%= vehicle.inv_model %> (<%= vehicle.inv_year %>)</strong></p>
  <p style="margin: 0; color: #666; font-size: 0.9em;">Price: $<%= new Intl.NumberFormat('en-US').format(vehicle.inv_price) %></p>
</div>

<form action="/review/add" method="post">
  <label for="review_rating">Rating (1-5 stars) *</label>
  <select id="review_rating" name="review_rating" required>
    <option value="">-- Select a rating --</option>
    <option value="5" <%= locals.review_rating == 5 ? 'selected' : '' %>>5 Stars - Excellent</option>
    <option value="4" <%= locals.review_rating == 4 ? 'selected' : '' %>>4 Stars - Good</option>
    <option value="3" <%= locals.review_rating == 3 ? 'selected' : '' %>>3 Stars - Average</option>
    <option value="2" <%= locals.review_rating == 2 ? 'selected' : '' %>>2 Stars - Poor</option>
    <option value="1" <%= locals.review_rating == 1 ? 'selected' : '' %>>1 Star - Very Poor</option>
  </select>

  <label for="review_text">Your Review (10-500 characters) *</label>
  <textarea 
    id="review_text" 
    name="review_text" 
    required 
    minlength="10" 
    maxlength="500"
    placeholder="Share your experience with this vehicle..."
    style="height: 150px;"><%= locals.review_text || '' %></textarea>
  <p style="font-size: 0.9em; color: #666; margin-top: -0.5rem;">Characters: <span id="charCount">0</span>/500</p>

  <input type="hidden" name="inv_id" value="<%= inv_id %>">

  <button type="submit">Submit Review</button>
  <a href="/inv/detail/<%= inv_id %>" style="display: inline-block; margin-left: 1rem; color: #005b96; text-decoration: underline;">Cancel</a>
</form>

<script>
  const textarea = document.getElementById('review_text');
  const charCount = document.getElementById('charCount');
  
  function updateCharCount() {
    charCount.textContent = textarea.value.length;
  }
  
  textarea.addEventListener('input', updateCharCount);
  updateCharCount();
</script>
